<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Generador de QR y Excel</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
    #qrcodes { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; margin-top: 20px; }
    .qr-container { text-align: center; }
  </style>
</head>
<body>
  <h1>Generador de CÃ³digos QR y Excel</h1>
  <label for="cantidad">Cantidad de seriales:</label>
  <input type="number" id="cantidad" min="1" max="100" value="5">
  <button onclick="generarTodo()">Generar</button>
  <button onclick="descargarExcel()">Descargar Excel</button>

  <div id="qrcodes"></div>

  <script>
    let seriales = [];

    function generarTodo() {
      const cantidad = parseInt(document.getElementById("cantidad").value);
      const contenedor = document.getElementById("qrcodes");
      contenedor.innerHTML = "";
      seriales = [];

      for (let i = 1; i <= cantidad; i++) {
        const serial = `SERIAL${String(i).padStart(3, '0')}`;
        seriales.push([serial]);

        const div = document.createElement("div");
        div.className = "qr-container";
        const qrDiv = document.createElement("div");
        new QRCode(qrDiv, {
          text: serial,
          width: 128,
          height: 128
        });
        const label = document.createElement("p");
        label.textContent = serial;
        div.appendChild(qrDiv);
        div.appendChild(label);
        contenedor.appendChild(div);
      }
    }

    function descargarExcel() {
      const wb = XLSX.utils.book_new();
      const ws = XLSX.utils.aoa_to_sheet([["Serial"], ...seriales]);
      XLSX.utils.book_append_sheet(wb, ws, "Seriales");
      XLSX.writeFile(wb, "seriales.xlsx");
    }
  </script>
</body>
</html>

